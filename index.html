
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Open edX Commits Dashboard</title>

<link rel="stylesheet" href="https://unpkg.com/@primer/css/dist/primer.css">

<style>

:root {
  color-scheme: light dark;
}

body {
  transition: background .3s, color .3s;
  background: #ffffff !important;
  color: #24292f !important;
}

body.dark-mode {
  background: #0d1117 !important;
  color: #c9d1d9 !important;
}

.container {
  max-width: 1100px;
  margin: auto;
  padding: 20px;
}

.commit {
  border: 1px solid #d0d7de;
  border-radius: 10px;
  padding: 10px 16px;
  margin-bottom: 10px;
  border-left: 6px solid transparent;
  background: #ffffff !important;
  color: #24292f !important;
}

.commit.breaking {
  border-left: 6px solid #d73a49;
  background: #fff5f5 !important;
}

body.dark-mode .commit {
  border-color: #30363d !important;
  background: #161b22 !important;
  color: #c9d1d9 !important;
}

body.dark-mode .commit.breaking {
  border-left: 6px solid #f85149 !important;
  background: #2a1618 !important;
}

.breaking-badge {
  display: inline-block;
  background: #d73a49;
  color: #ffffff;
  padding: 2px 8px;
  border-radius: 6px;
  font-size: 12px;
  margin-right: 6px;
}

.controls input,
.controls select {
  margin-right: 6px;
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid #d0d7de;
  background: #ffffff !important;
  color: #24292f !important;
}

body.dark-mode .controls input,
body.dark-mode .controls select {
  background: #161b22 !important;
  color: #c9d1d9 !important;
  border: 1px solid #30363d !important;
}

.repo-select {
  position: relative;
  display: inline-block;
  min-width: 300px;
  margin: 10px 0;
}

.repo-select__button {
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  border: 1px solid #d0d7de;
  border-radius: 6px;
  background: #fff !important;
  color: #24292f !important;
  cursor: pointer;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 400px;
}

body.dark-mode .repo-select__button {
  background: #161b22 !important;
  color: #c9d1d9 !important;
  border: 1px solid #30363d !important;
}

.repo-select__dropdown {
  position: absolute;
  z-index: 1000;
  background: #fff !important;
  border: 1px solid #d0d7de;
  border-radius: 6px;
  margin-top: 2px;
  width: 100%;
  max-height: 220px;
  overflow-y: auto;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

body.dark-mode .repo-select__dropdown {
  background: #161b22 !important;
  border: 1px solid #30363d !important;
}

.repo-select__dropdown label {
  display: flex;
  align-items: center;
  padding: 6px 12px;
  cursor: pointer;
  gap: 8px;
}

.repo-select__dropdown input[type="checkbox"] {
  margin-right: 8px;
}

.chart-box {
  border: 1px solid #d0d7de;
  padding: 10px;
  border-radius: 10px;
}

body.dark-mode .chart-box {
  border-color: #30363d !important;
  background: #161b22 !important;
}

</style>
</head>

<body>

<div class="container">
<h1>üöÄ Open edX commits (last 2 days)</h1>

<button onclick="toggleDark()" class="btn">üåô Toggle dark mode</button>

<hr>

<div class="controls">
  <input id="searchBox" placeholder="Search keyword‚Ä¶" oninput="render()">
  <input id="authorBox" placeholder="Filter author‚Ä¶" oninput="render()">

  <div class="repo-select" id="repoSelect">
    <button type="button" class="repo-select__button" id="repoSelectBtn" onclick="toggleRepoDropdown()">
      <span id="repoSelectLabel">All repositories</span>
      <span style="float:right;">‚ñº</span>
    </button>
    <div class="repo-select__dropdown" id="repoSelectDropdown" style="display:none;">
      <label><input type="checkbox" class="repo-checkbox" value="openedx/edx-platform" checked onchange="updateRepoSelectLabel();render()"> openedx/edx-platform</label><label><input type="checkbox" class="repo-checkbox" value="openedx/frontend-app-learning" checked onchange="updateRepoSelectLabel();render()"> openedx/frontend-app-learning</label><label><input type="checkbox" class="repo-checkbox" value="openedx/frontend-app-authoring" checked onchange="updateRepoSelectLabel();render()"> openedx/frontend-app-authoring</label><label><input type="checkbox" class="repo-checkbox" value="openedx/frontend-app-discussions" checked onchange="updateRepoSelectLabel();render()"> openedx/frontend-app-discussions</label><label><input type="checkbox" class="repo-checkbox" value="openedx/XBlock" checked onchange="updateRepoSelectLabel();render()"> openedx/XBlock</label><label><input type="checkbox" class="repo-checkbox" value="openedx/paragon" checked onchange="updateRepoSelectLabel();render()"> openedx/paragon</label><label><input type="checkbox" class="repo-checkbox" value="openedx/edx-celeryutils" checked onchange="updateRepoSelectLabel();render()"> openedx/edx-celeryutils</label><label><input type="checkbox" class="repo-checkbox" value="openedx/frontend-base" checked onchange="updateRepoSelectLabel();render()"> openedx/frontend-base</label><label><input type="checkbox" class="repo-checkbox" value="openedx/frontend-app-ora" checked onchange="updateRepoSelectLabel();render()"> openedx/frontend-app-ora</label><label><input type="checkbox" class="repo-checkbox" value="openedx/frontend-platform" checked onchange="updateRepoSelectLabel();render()"> openedx/frontend-platform</label><label><input type="checkbox" class="repo-checkbox" value="openedx/frontend-plugin-framework" checked onchange="updateRepoSelectLabel();render()"> openedx/frontend-plugin-framework</label><label><input type="checkbox" class="repo-checkbox" value="openedx/frontend-app-gradebook" checked onchange="updateRepoSelectLabel();render()"> openedx/frontend-app-gradebook</label>
    </div>
  </div>

  <input id="repoBox" placeholder="Repo contains‚Ä¶" oninput="render()">

  <label>
    <input type="checkbox" id="breakingOnly" onchange="render()">
    Show only breaking
  </label>
</div>

<h3>üìä Commit count</h3>
<div class="chart-box">
  <canvas id="chart" height="80"></canvas>
</div>

<h3>üß≠ Commits</h3>
<div id="commits"></div>

<p>Last generated: 2026-01-15 07:44 UTC</p>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
const commits = [{"repo": "openedx/edx-platform", "message": "fix: remove the branch/version while building BS (#37866)", "author": "Muhammad Arslan", "date": "2026-01-15T01:26:45Z", "url": "https://github.com/openedx/edx-platform/commit/328b3ee3fa00c507e25aec72b0e8a34195d54724", "is_breaking": true, "breaking_methods": ["keyword"]}, {"repo": "openedx/edx-platform", "message": "Merge pull request #37881 from openedx/feanil/make_upgrade", "author": "Feanil Patel", "date": "2026-01-14T23:37:01Z", "url": "https://github.com/openedx/edx-platform/commit/e1fb2d843b20b4e2302fb624690ee66bf704e135", "is_breaking": false, "breaking_methods": []}, {"repo": "openedx/edx-platform", "message": "Merge pull request #37872 from openedx/feanil/update_gitignore", "author": "Feanil Patel", "date": "2026-01-14T15:31:15Z", "url": "https://github.com/openedx/edx-platform/commit/bac5e7efc623be20c4bd516979c1c2a1b6b876ec", "is_breaking": false, "breaking_methods": []}, {"repo": "openedx/edx-platform", "message": "Merge pull request #37874 from openedx/feanil/remove_unused_bad_code", "author": "Feanil Patel", "date": "2026-01-14T15:26:03Z", "url": "https://github.com/openedx/edx-platform/commit/3dec1abcc9dbde1123e052af313c4c004209afd2", "is_breaking": true, "breaking_methods": ["keyword"]}, {"repo": "openedx/edx-platform", "message": "fix: Pass in a referrer when logging.", "author": "Feanil Patel", "date": "2026-01-14T15:23:12Z", "url": "https://github.com/openedx/edx-platform/commit/a5f022a1cd892fd4b8665149159f6b89b50c7081", "is_breaking": false, "breaking_methods": []}, {"repo": "openedx/edx-platform", "message": "Revert \"refactor: hoist annotations for common settings with differing values\u2026\" (#37883)", "author": "Ahtisham Shahid", "date": "2026-01-14T15:08:04Z", "url": "https://github.com/openedx/edx-platform/commit/d71d46e313be79514114dc1b865795f8d896e249", "is_breaking": false, "breaking_methods": []}, {"repo": "openedx/edx-platform", "message": "fix: celery issue with eta/countdown affecting grading", "author": "David Ormsbee", "date": "2026-01-14T03:58:39Z", "url": "https://github.com/openedx/edx-platform/commit/3430dbd0503395e8ffb9dbcbd278622a7cd1a450", "is_breaking": false, "breaking_methods": []}, {"repo": "openedx/edx-platform", "message": "Merge pull request #37878 from openedx/feanil/update_readme_python_version", "author": "Feanil Patel", "date": "2026-01-13T21:38:20Z", "url": "https://github.com/openedx/edx-platform/commit/aea900061aaa8a098801d1b01484f999ee9b355a", "is_breaking": false, "breaking_methods": []}, {"repo": "openedx/edx-platform", "message": "docs: Apply suggestion from @kdmccormick", "author": "Feanil Patel", "date": "2026-01-13T19:17:59Z", "url": "https://github.com/openedx/edx-platform/commit/6062c04e8aefb48fe3d5a4d44b2294e0d7169d86", "is_breaking": false, "breaking_methods": []}, {"repo": "openedx/edx-platform", "message": "Merge pull request #37879 from irfanuddinahmad/iahmad/ENT-10552", "author": "irfanuddinahmad", "date": "2026-01-13T16:40:40Z", "url": "https://github.com/openedx/edx-platform/commit/e6deac0cf12226c0b8d744ad17395373cfe0de03", "is_breaking": false, "breaking_methods": []}, {"repo": "openedx/edx-platform", "message": "build: Constrain sphinx-autoapi to fix make upgrade", "author": "Feanil Patel", "date": "2026-01-13T16:15:16Z", "url": "https://github.com/openedx/edx-platform/commit/99684cb7f19a831291a33b5c59f140a20edd3a7a", "is_breaking": false, "breaking_methods": []}, {"repo": "openedx/edx-platform", "message": "chore: updated version of enterprise-integrated-channels", "author": "irfanuddinahmad", "date": "2026-01-13T15:56:17Z", "url": "https://github.com/openedx/edx-platform/commit/6e59e0f248a04b25f978243cfcc681cbab4a9805", "is_breaking": false, "breaking_methods": []}, {"repo": "openedx/edx-platform", "message": "Removed DEFAULT_HASHING_ALGORITHM from lms (#37820)", "author": "jawad khan", "date": "2026-01-13T13:13:52Z", "url": "https://github.com/openedx/edx-platform/commit/99e7492b5e5a0b65f739f02119a27c0ae922567b", "is_breaking": true, "breaking_methods": ["keyword"]}];

let chart = null;

// --- Repo select dropdown logic ---
function toggleRepoDropdown() {
  const dropdown = document.getElementById("repoSelectDropdown");
  dropdown.style.display = dropdown.style.display === "none" ? "block" : "none";
}

function closeRepoDropdownOnClickOutside(e) {
  const select = document.getElementById("repoSelect");
  if (!select.contains(e.target)) {
    document.getElementById("repoSelectDropdown").style.display = "none";
  }
}
document.addEventListener("mousedown", closeRepoDropdownOnClickOutside);

function updateRepoSelectLabel() {
  const checked = Array.from(document.querySelectorAll(".repo-checkbox:checked"));
  const all = document.querySelectorAll(".repo-checkbox").length;
  let label = "";
  if (checked.length === 0) {
    label = "No repositories";
  } else if (checked.length === all) {
    label = "All repositories";
  } else if (checked.length <= 3) {
    label = checked.map(x => x.value).join(", ");
  } else {
    label = checked.length + " repositories selected";
  }
  document.getElementById("repoSelectLabel").textContent = label;
}

// --- End repo select dropdown logic ---

function toggleDark() {
  document.body.classList.toggle("dark-mode");

  const isDark = document.body.classList.contains("dark-mode");

  if (chart) {
    chart.options.scales.x.ticks.color = isDark ? "#e5e7eb" : "#111827";
    chart.options.scales.y.ticks.color = isDark ? "#e5e7eb" : "#111827";
    chart.update();
  }
}

function hoursAgo(d) {
  const then = new Date(d);
  const diff = (new Date() - then) / 3600000;
  if (diff < 1) return Math.round(diff * 60) + " minutes ago";
  return Math.round(diff) + " hours ago";
}

function render() {

  const search = (document.getElementById("searchBox")?.value || "").toLowerCase();
  const author = (document.getElementById("authorBox")?.value || "").toLowerCase();
  const repoText = (document.getElementById("repoBox")?.value || "").toLowerCase();
  const breakingOnly = document.getElementById("breakingOnly")?.checked;

  const repoCheckboxes = document.querySelectorAll(".repo-checkbox:checked");
  let selectedRepos = Array.from(repoCheckboxes).map(x => x.value);

  const grouped = {};

  commits.forEach(c => {

    if (search && !c.message.toLowerCase().includes(search)) return;
    if (author && !c.author.toLowerCase().includes(author)) return;

    if (selectedRepos.length && !selectedRepos.includes(c.repo)) return;

    if (repoText && !c.repo.toLowerCase().includes(repoText)) return;

    if (breakingOnly && !c.is_breaking) return;

    if (!grouped[c.repo]) grouped[c.repo] = [];
    grouped[c.repo].push(c);
  });

  // ---- commits HTML ----
  let html = "";

  Object.keys(grouped).forEach(repo => {
    html += "<h2>üì¶ " + repo + "</h2>";

    grouped[repo].forEach(c => {

      const badge = c.is_breaking
        ? '<span class="breaking-badge">‚ö† BREAKING</span>'
        : "";

      const cls = c.is_breaking ? "breaking" : "";

      html += `
        <div class="commit ${cls}">
          ${badge}<b>${c.message}</b><br>
          üë§ ${c.author} ‚Äî ‚è∞ ${hoursAgo(c.date)}<br>
          üîó <a href="${c.url}" target="_blank">View commit</a>
        </div>
      `;
    });
  });

  document.getElementById("commits").innerHTML = html;

  // ---- chart ----
  const labels = Object.keys(grouped);
  const values = labels.map(r => grouped[r].length);

  if (!chart) {
    chart = new Chart(document.getElementById("chart"), {
      type: "bar",
      data: {
        labels: labels,
        datasets: [{ label: "Commits", data: values }]
      },
      options: { responsive: true }
    });
  } else {
    chart.data.labels = labels;
    chart.data.datasets[0].data = values;
    chart.update();
  }

}

updateRepoSelectLabel();
render();

</script>

</body>
</html>
